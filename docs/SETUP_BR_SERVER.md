# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPN —Å–µ—Ä–≤–µ—Ä–∞ –≤ –ë—Ä–∞–∑–∏–ª–∏–∏ (BR)

## üö® –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏

### –®–ê–ì 1: WireGuard –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–§–∞–π–ª:** `/etc/wireguard/wg0.conf`

```ini
[Interface]
Address = 10.10.0.1/24
ListenPort = 443
PrivateKey = SERVER_PRIVATE_KEY
MTU = 1280
PostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -s 10.10.0.0/24 -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -s 10.10.0.0/24 -o eth0 -j MASQUERADE
```

**–í–∞–∂–Ω–æ:**
- ‚úÖ –ü–æ—Ä—Ç **443/UDP** (–ª—É—á—à–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ DPI)
- ‚úÖ **MTU = 1280** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –†–§)
- ‚úÖ –ü–æ–¥—Å–µ—Ç—å **10.10.0.0/24** (–æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)

### –®–ê–ì 2: –í–∫–ª—é—á–∏—Ç—å —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥

```bash
echo "net.ipv4.ip_forward=1" >> /etc/sysctl.conf
sysctl -p
```

### –®–ê–ì 3: NAT (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

```bash
# –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
MAIN_IF=$(ip route | grep default | awk '{print $5}' | head -1)

# –î–æ–±–∞–≤–∏—Ç—å NAT –ø—Ä–∞–≤–∏–ª–æ
iptables -t nat -A POSTROUTING -s 10.10.0.0/24 -o $MAIN_IF -j MASQUERADE

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞
apt install -y iptables-persistent
netfilter-persistent save
```

### –®–ê–ì 4: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**

```bash
# –ù–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/vpn-service
git pull

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–¥—Å–µ—Ç—å—é
WG_NETWORK=10.10.0.0/24 bash scripts/setup-wireguard.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ MTU —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
grep MTU /etc/wireguard/wg0.conf

# –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ backend
bash scripts/register-wireguard-server.sh http://API_SERVER_IP:3000 server2
```

## üìã –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–ë–µ–∑ MTU = 1280 –≤ –†–§ –±—É–¥–µ—Ç "–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç".**

```ini
[Interface]
PrivateKey = CLIENT_PRIVATE_KEY
Address = 10.10.0.2/32
DNS = 1.1.1.1
MTU = 1280

[Peer]
PublicKey = SERVER_PUBLIC_KEY
Endpoint = BR_SERVER_IP:443
AllowedIPs = 0.0.0.0/0
PersistentKeepalive = 25
```

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- ‚úÖ `MTU = 1280` - –±–µ–∑ —ç—Ç–æ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –†–§
- ‚úÖ `DNS = 1.1.1.1` - Cloudflare DNS
- ‚úÖ `Endpoint = ...:443` - –ø–æ—Ä—Ç 443/UDP
- ‚úÖ `PersistentKeepalive = 25` - –¥–ª—è –æ–±—Ö–æ–¥–∞ NAT

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

**–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ (–ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è):**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ ping
ping 1.1.1.1

# ‚úÖ –∏–¥—ë—Ç ‚Üí –≤—Å—ë –æ–∫
# ‚ùå –Ω–µ—Ç ‚Üí DPI / –ø–æ—Ä—Ç / MTU –ø—Ä–æ–±–ª–µ–º–∞
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å WireGuard
systemctl status wg-quick@wg0

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å peers
wg show wg0

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å MTU
ip link show wg0 | grep mtu
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: mtu 1280

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å NAT –ø—Ä–∞–≤–∏–ª–∞
iptables -t nat -L POSTROUTING -n | grep MASQUERADE
```

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞

**50 –ú–±–∏—Ç/—Å:**
- ~6 MB/s
- –î–ª—è 10‚Äì20 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–∫
- –ù–µ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

**–î–ª—è MVP ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ.**

## üöÄ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –°–µ–≥–æ–¥–Ω—è:
1. ‚úÖ –ü–æ–¥–Ω—è—Ç—å WG –≤ BR
2. ‚úÖ MTU = 1280
3. ‚úÖ –ü–æ—Ä—Ç 443/UDP
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑ –†–§

### –ß–µ—Ä–µ–∑ 1‚Äì2 –¥–Ω—è:
- –î–æ–±–∞–≤–∏—Ç—å obfuscation (udp2raw)
- –ò–ª–∏ –≤—Ç–æ—Ä–æ–π —Å–µ—Ä–≤–µ—Ä (TR / AM)

### –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é:
- –ê–≤—Ç–æ-fallback —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ handshake/data

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–æ —Å–∫–æ—Ä–æ—Å—Ç—å

**–ü–∏–Ω–≥ –±—É–¥–µ—Ç:**
- 180‚Äì220 ms (–∏–∑ –†–§ –≤ BR)

**–ù–æ:**
- ‚úÖ YouTube, —Å–∞–π—Ç—ã ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Telegram ‚Äî –æ—Ç–ª–∏—á–Ω–æ
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–µ–¥–ø–æ—á—Ç—É—Ç —Ä–∞–±–æ—á–∏–π VPN –º–µ–¥–ª–µ–Ω–Ω–æ–º—É, –Ω–æ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–µ–º—É

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–æ–¥—Å–µ—Ç–∏ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤

- **Server 1 (DE):** `10.0.0.0/24` (IP: 10.0.0.2-254)
- **Server 2 (BR):** `10.10.0.0/24` (IP: 10.10.0.2-254)
- **Server 3 (TR):** `10.20.0.0/24` (IP: 10.20.0.2-254)
- **Server 4 (AM):** `10.30.0.0/24` (IP: 10.30.0.2-254)

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ IP –∞–¥—Ä–µ—Å–æ–≤ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

